# 🏠 מערכת בדיקת תוכניות ממ״ד - מדריך שימוש

## תיאור המערכת

מערכת אוטומטית לבדיקת תוכניות אדריכליות של מרחבים מוגנים דירתיים (ממ״ד) בהתאם לדרישות פיקוד העורף הישראלי. המערכת משתמשת ב-GPT-5.1 של Azure OpenAI עם יכולות חשיבה מתקדמות לניתוח תוכניות ובדיקת עמידה ב-20 הדרישות הרגולטוריות.

## ✨ תכונות עיקריות

- 🤖 **ניתוח אוטומטי עם GPT-5.1**: המודל מנתח את התוכנית ומזהה מידות, קירות, ומאפיינים קונסטרוקטיביים
- 📋 **20 בדיקות רגולטוריות**: בדיקה מלאה מול כל הדרישות של פיקוד העורף
- 🔍 **פירוט מלא**: תצוגה מפורטת של מה המודל הבין ואיך הוא הגיע למסקנה
- 🌐 **ממשק בעברית**: כל הממשק בעברית עם RTL support
- ☁️ **Azure Entra ID**: אבטחה מלאה עם אימות Managed Identity (ללא secrets)

## 🚀 התחלה מהירה

### 1. הפעלת השרת

```bash
# הפעל את ה-backend
cd /Users/robenhai/aga
source .venv/bin/activate
python -m uvicorn src.api.main:app --reload

# הפעל את ה-frontend (בטרמינל נפרד)
cd frontend
npm run dev
```

השרת יעלה על:
- Backend: http://localhost:8000
- Frontend: http://localhost:5173
- API Docs: http://localhost:8000/docs

### 2. העלאת תוכנית

1. פתח את הממשק ב-http://localhost:5173
2. הזן מזהה פרויקט (למשל: `demo-project-001`)
3. גרור ושחרר תוכנית או לחץ להעלאה
4. לחץ על **"בדוק תוכנית"**
5. המתן 30-90 שניות לניתוח GPT-5.1
6. צפה בתוצאות המפורטות

## 📊 תוכניות דוגמה למצגות

### 1️⃣ `demo_plan_thin_walls.png` - קירות דקים מדי
**בעיה**: 4 קירות חיצוניים בעובי 35-40 ס"מ במקום 62 ס"מ הנדרשים

**תוצאה צפויה**:
- ❌ **סטטוס**: נכשל
- **הפרות**: בדיקת עובי קירות (1.2) - עובי קירות לא תואם למספר הקירות החיצוניים
- **פירוט**: כאשר יש 4 קירות חיצוניים, עובי הקירות חייב להיות 62 ס"מ לפחות

**שימוש בהצגה**: הראה כיצד המערכת מזהה אי-התאמה בין מספר קירות לעוביים

---

### 2️⃣ `demo_plan_low_height.png` - גובה חדר נמוך מדי
**בעיה**: גובה חדר 2.30 מ' במקום 2.50 מ' המינימלי

**תוצאה צפויה**:
- ❌ **סטטוס**: נכשל
- **הפרות**: בדיקת גובה (2.1) - גובה ממ"ד נמוך מהמינימום
- **פירוט**: גובה מינימלי נדרש: 2.50 מ', זוהה: 2.30 מ'
- **הערה**: גם כאשר נפח החדר מעל 22.5 מ"ק, הגובה חייב להיות 2.50 מ' למעט במקרים מיוחדים (מרתף/תוספת)

**שימוש בהצגה**: הדגם כיצד המודל מבין את הקשר בין גובה לנפח ודורש עמידה בתקנים

---

### 3️⃣ `demo_plan_perfect.png` - תוכנית מושלמת ✅
**מאפיינים**:
- 3 קירות חיצוניים בעובי 62 ס"מ ✓
- גובה חדר 2.70 מ' ✓
- מרחקי דלת וחלון תקינים ✓
- סימון מערכת אוורור לפי ת"י 4570 ✓
- כל התשתיות הנדרשות ✓
- חומרים תקניים (בטון ב-30, פלדה מעוגלת) ✓
- זיון בפסיעות נכונות ✓

**תוצאה צפויה**:
- ✅ **סטטוס**: עבר
- **בדיקות**: 20/20 עברו בהצלחה
- **רמת ביטחון**: גבוהה (70-90%)

**שימוש בהצגה**: הראה תוכנית אופטימלית שעומדת בכל הדרישות והציג את הפירוט המלא

---

### 4️⃣ `demo_plan_door_spacing.png` - מרחק דלת לא תקין
**בעיה**: מרחק דלת מקיר ניצב 60 ס"מ במקום 90 ס"מ המינימלי

**תוצאה צפויה**:
- ❌ **סטטוס**: נכשל
- **הפרות**: בדיקת מרחקי דלת (3.1) - מרחק דלת מקיר ניצב קטן מהנדרש
- **פירוט**: נדרש: ≥90 ס"מ, זוהה: 60 ס"מ

**שימוש בהצגה**: הדגם את יכולת המודל לזהות מרחקים ולהשוות אותם לדרישות

---

### 5️⃣ `image-test-1.png` - תוכנית מורכבת
תוכנית אמיתית יותר עם פרטים רבים לבדיקה מקיפה

### 6️⃣ `test_mamad_plan.png` - תוכנית פשוטה
תוכנית בסיסית לבדיקות מהירות

## 🎯 תרחישי שימוש להצגה

### תרחיש 1: בדיקה מהירה (5 דקות)
1. העלה `demo_plan_perfect.png`
2. הראה שהמודל זיהה את כל הפרטים
3. הציג את רמת הביטחון הגבוהה
4. הראה שכל 20 הבדיקות עברו

### תרחיש 2: זיהוי בעיות (10 דקות)
1. העלה `demo_plan_thin_walls.png`
2. הראה איך המודל זיהה את מספר הקירות
3. הציג את ההפרה - עובי לא תואם למספר קירות
4. הסבר את הדרישה הרגולטורית מ-requirements-mamad.md
5. העלה `demo_plan_low_height.png`
6. הראה בעיית גובה והסבר את החריגים המותרים

### תרחיש 3: השוואה (15 דקות)
1. העלה תוכנית עם בעיות
2. הראה את ההפרות המפורטות
3. העלה את `demo_plan_perfect.png`
4. הראה השוואה - איך תוכנית תקינה צריכה להיראות
5. הדגש את ה-reasoning של GPT-5.1

## 📖 20 הבדיקות שהמערכת מבצעת

### קטגוריה 1: קירות חיצוניים ועוביים
1. **1.1 מספר קירות חיצוניים** - בין 1-4 קירות
2. **1.2 עובי קירות** - התאמה למספר קירות (52-62 ס"מ)

### קטגוריה 2: גובה ונפח
3. **2.1 גובה סטנדרטי** - מינימום 2.50 מ'
4. **2.2 חריגה מותרת** - 2.20 מ' רק במרתף עם נפח ≥22.5 מ"ק

### קטגוריה 3: פתחים - דלת וחלון
5. **3.1 מרחק דלת מקיר פנימי** - ≥90 ס"מ
6. **3.2 מרחק דלת מקיר חיצוני** - ≥75 ס"מ
7. **3.3 מרחק בין נישות חלון** - ≥20 ס"מ
8. **3.4 מרחק בין פתחי אור** - ≥100 ס"מ
9. **3.5 מרחק חלון מקיר** - ≥20 ס"מ

### קטגוריה 4: מערכת אוורור וסינון
10. **4.1 פתיחת פתחים** - אפשרות פתיחה ל-20° לפחות
11. **4.2 סימון בתוכנית** - חובת ציון "לפי ת״י 4570"

### קטגוריה 5: תשתיות וצנרת
12. **5.1 צינור כניסת אוויר** - קוטר 4"
13. **5.2 צינור פליטת אוויר** - קוטר 4"
14. **5.3 מעבר מיזוג** - מעבר מודולרי או שני צינורות
15. **5.4 מעבר חשמל/תקשורת** - מעבר מודולרי מאושר

### קטגוריה 6: חומרים ובטון
16. **6.1 סוג בטון** - ב-30 לפחות
17. **6.2 סוג פלדה** - מעוגלת בחום בלבד
18. **6.3 זיון** - פסיעות תקניות (חיצוני 20 ס"מ, פנימי 10 ס"מ)

### קטגוריה 7 & 8: תקנים ומגבלות
19. **7.1 אישורים** - פתחים לפי ת"י 4422
20. **8.1 מגבלות שימוש** - לא מעבר בין חדרים, לא ארונות צמודים

## 🔧 אדריכלות טכנית

### Backend
- **FastAPI** - Framework מודרני לבניית API
- **Python 3.12** - עם async/await
- **Azure OpenAI GPT-5.1** - מודל reasoning עם vision
- **Azure Cosmos DB** - אחסון תוצאות
- **Azure Blob Storage** - אחסון תוכניות
- **Azure Entra ID** - אימות Managed Identity

### Frontend
- **React 18** - עם TypeScript
- **Vite** - Build tool מהיר
- **TailwindCSS 4.0** - עיצוב responsive
- **RTL Support** - תמיכה מלאה בעברית

### אבטחה
- **ללא Secrets**: כל האימות דרך Azure Entra ID
- **RBAC**: הרשאות מדויקות לכל שירות
- **DefaultAzureCredential**: פועל בענן ובפיתוח מקומי

## 📈 מדדי ביצועים

- **זמן ניתוח**: 30-90 שניות (תלוי במורכבות התוכנית)
- **רמת דיוק**: תלוי באיכות התוכנית - תוכניות ברורות משיגות 70-90% confidence
- **תמיכה בפורמטים**: PNG, JPG, PDF (המלצה: תמונות ברזולוציה גבוהה)

## 💡 טיפים להצגה מוצלחת

1. **התחל עם Perfect Plan**: הראה תוכנית שעוברת הכל כדי להציג את המערכת במיטבה
2. **הדגש את ה-Reasoning**: הסבר איך GPT-5.1 משתמש ביכולות חשיבה מתקדמות
3. **הראה פירוט**: הדגש את הפירוט המלא של מה המודל הבין
4. **השווה**: העלה תוכנית עם בעיות ואחר כך perfect plan
5. **הצג את requirements-mamad.md**: פתח את הקובץ והראה את הדרישות המקוריות

## 🛠️ פתרון בעיות נפוצות

### המודל לא זיהה פרטים בתוכנית
- **פתרון**: וודא שהתוכנית בעלת רזולוציה גבוהה וטקסט ברור
- **טיפ**: הוסף annotations בולטות על התוכנית

### רמת ביטחון נמוכה
- **סיבה**: תוכנית חסרת פרטים או לא ברורה
- **פתרון**: שפר את האיכות של התוכנית, הוסף מידות ותיאורים

### תוצאות לא מדויקות
- **בדוק**: האם הפרטים בתוכנית ברורים למודל?
- **שפר**: הוסף קווי מידה, annotations, ותיאורים

## 📧 יצירת קשר ותמיכה

מערכת זו פותחה כהדגמה טכנולוגית לשימוש GPT-5.1 בבדיקות רגולטוריות.

---

**🎉 בהצלחה בהצגה!**
